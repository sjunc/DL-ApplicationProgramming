
# 딥러닝 응용 프로그래밍
----  
기본 개념 복습  
인공지능 EX.전문가 시스템  
  |  
머신러닝 EX.인공신경망(ANN), SVM, DecisionTree  
  |  
딥러닝 EX.CNN(Convolutional Neural Network, RNN(Recurrent Neural Network), RBM(Restricted Boltzmann Machine)    

## 2주차 인공지능(AI, Artificial Intelligence)  
 정의  
- 인간의 지능적인 작업을 컴퓨터 시스템이 수행하도록 하는 기술과 학문 분야  
- 문제 해결, 추론, 학습, 자연어 처리, 로봇 제어 등이 포함됨  
 예  
- 챗봇 (예: ChatGPT) - 자율 주행 자동차  
- 음성 인식 (예: STT(Speech-to-Text) 시스템)  
- 가상 비서(Virtual Assistant) (예: Siri, Google Assistant)
    
### 머신러닝(ML, Machine Learning)  
정의  
- 인공지능의 하위 분야로, 컴퓨터가 명시적으로 프로그래밍되지 않고도 데이터를 학습하여 예측하거나 결정을 내리는 기술   
- 지도학습, 비지도학습, 강화학습으로 구분됨   
예  
- 이메일 스팸 필터링 (스팸/정상 메일 분류) classfication  
- 추천 시스템 (예: 넷플릭스 영화 추천)  
- 질병 진단 모델 (의료 데이터 분석)  
    
=컴퓨터가 학습할 수 있게 하는 알고리즘과 기술을 개발하는 분야  
  
• 머신 러닝 학습 과정  
• 머신 러닝은 학습 단계(learning)와 예측 단계(prediction)로 이루어짐  
• 학습 단계에서는 학습 데이터를 대상으로 머신 러닝 알고리즘을 적용하여 학습시키고, 이 학습 결과로 모형(model)이 생성됨  
• 예측 단계에서는 학습 단계에서 생성된 모형에 새로운 데이터를 적용하여 결과를 예측함  
   
과정   
특성 추출, 특징 추출(feature extraction)   
• 컴퓨터가 입력받은 데이터를 분석하여 일정한 패턴이나 규칙을 찾아 내려면 사람이 인지하는 데이터를 컴퓨터가 인지할 수 있는 데이터로 변환해 주어야 함  
• 이때 데이터별로 어떤 특징을 가지고 있는지 찾아내고, 그것을 토대로 데이터를 벡터로 변환하는 작업을 특성 추출이라고 함   
  
머신 러닝의 주요 구성 요소는 데이터와 모델(모형)   
데이터(자료)는 머신 러닝이 학습 모델을 만드는 데 사용하는 것  
편향되지 않는 훈련 데이터를 확보하는 것이 중요함  
또한, 학습에 필요한 데이터가 수집되었다면 훈련을 위해 ‘훈련 데이터셋’과 ‘검증 데이터셋’ 용도로 분리해서 사용  
보통 데이터의 80%는 훈련용으로, 20%는 검증용으로 분리해서 사용  

모델(model)은 머신 러닝의 학습 단계에서 얻은 최종 결과물로 가설이라고도 함  
• 예를 들어 “입력 데이터의 패턴은 A와 같다.”라는 가정을 머신 러닝에서는 모델이라고 함  
• 모델의 학습 절차는 다음과 같음  
1. 모델(또는 가설) 선택    
2. 모델 학습 및 평가   
3. 평가를 바탕으로 모델 업데이트(개선)  
    
• 이 세 단계를 반복하면서 주어진 문제를 가장 잘 풀 수 있는 모델을 찾음  
  
머신러닝 지도학습 / 비지도 학습 / 강화 학습 ->  
### 딥러닝(DL, Deep Learning)   
정의  
- 머신러닝의 하위 분야로, 인간의 뇌 신경망을 모방한 인공신경망(ANN)을 사용하여 데이터를 학습하는 기술  
- 다층 신경망(Deep Neural Network)을 활용하여 복잡한 패턴을 분석하고 처리  
예
- 이미지 인식(얼굴 인식, 자율 주행 자동차의 카메라)  
- 자연어 처리(번역, 감정 분석, 챗봇)   
- 음성 합성 (TTS, 딥페이크 음성)    

딥러닝은 인간의 신경망 원리를 모방한 심층 신경망(Multi Layer) 이론을 기반으로 고안된 머신 러닝 방법의 일종  
• 인간의 뇌가 많은 수의 뉴런(neuron)과 시냅스(synapse)로 구성되어 있는 것에 착안하여 컴퓨터에 뉴런과 시냅스 개념을 적용함  
• 각각의 뉴런은 복잡하게 연결된 수많은 뉴런을 병렬 연산하여 기존에 컴퓨터가 수행하지 못했던 음성·영상 인식 등의 처리를 가능하게 함  

인간의 뉴런 구조  
수상돌기: 주변이나 다른 뉴런에서 자극을 받아들이고, 이 자극들을 전기적 신호 형태로 세포체와 축색돌기로 보내는 역할을 함  
시냅스: 신경 세포들이 이루는 연결 부위로, 한 뉴런의 축색돌기와 다음 뉴런의 수상돌기가 만나는 부분  
축삭돌기: 다른 뉴런(수상돌기)에 신호를 전달하는 기능을 하는 뉴런의 한 부분  
- 뉴런에서 뻗어 있는 돌기 중 가장 길며, 단 한 개만 있음  
축삭말단: 전달된 전기 신호를 받아 신경 전달 물질을 시냅스 틈새로 분비  
  
이걸 본 따 퍼셉트론으로 만듬  
   
1. 데이터 준비: 딥러닝을 통해 구현하고자 하는 기능에 필요한 데이터들을 수집하고 전처리함.  
2. 모델 정의: 모델 정의 단계에서 모델의 구조를 결정하고, 신경망을 생성함.  
일반적으로 은닉층 개수가 많을수록(깊을수록) 성능이 좋아지지만 과적합이 발생할 확률이 높음  
3. 모델 컴파일: 컴파일 단계에서 활성화 함수, 손실 함수, 옵티마이저를 선택  
훈련 데이터셋 형태가 연속형이라면 평균 제곱 오차(Mean Squared Error, MSE)를 사용할 수 있으며, 이진 분류(binary classification)라면 크로스 엔트로피(cross-entropy)를 선택할 수 있음   
4. 모델 훈련: 훈련 단계에서는 한 번에 처리할 데이터양을 적절하게 지정함   
전체 훈련 데이터셋에서 일정한 묶음으로 나누어 처리할 수 있는 배치(Batch)와 훈련의 횟수인 에폭(Epoch) 선택이 중요함.  
이때 파라미터와 하이퍼파라미터에 대한 최적의 값을 찾을 수 있어야 함  
5. 모델 평가: 검증 데이터셋을 생성한 모델에 적용하여 실제로 예측을 진행해보는 단계.  
성능이 낮다면 파라미터를 튜닝하거나, 신경망 자체를 재설계할 수 있음

ex. 훈련 데이터셋 1000개 있음.   
batch size 20, epoch 10번임.  
한번 훈련데이터 전체를 볼 때까지 가중치가 업데이터가 50번 총 500번의 가중치 변경이 일어남.  iteration  
  
딥러닝 학습 과정에서 중요한 핵심 구성 요소는 신경망과 역전파  
딥러닝은 머신 러닝의 한 분야이기는 하지만, 심층 신경망(deep neural network)을 가지고 있다는 점에서 머신 러닝과 차이가 있음  
심층 신경망에는 데이터셋의 어떤 특성들이 중요한지 스스로에게 가르쳐 줄 수 있는 기능이 있음  

|특징 | 머신러닝 | 딥러닝 | 
|------|---|------|
|데이터 요구량| 적은 데이터로도 가능 | 대량의 데이터 필요 (수십만~수백만 개)|
|특징 추출 | 사람이 직접 특징을 설계 | 모델이 스스로 특징을 추출|
|필요 연산량 | 비교적 낮음 (CPU 가능) | 높음 (GPU/TPU 연산 필요)|
|모델 해석 가능성 | 해석 가능 (규칙 기반 예측) | 해석이 어려움 (블랙박스)| 
|학습 속도 | 상대적으로 빠름 (수분~수시간) | 느림 ( 수십 ~ 수백만 개 데이터, 몇 시간 ~ 며칠 )|
|적용 사례 | 의사 결정 트리, 랜덤 포레스트,SVM, K-NN, 선형 회귀 | CNN (이미지 인식), RNN (자연어 처리),GAN (이미지 생성),트랜스포머 (ChatGPT, BERT)|  
  
GPT (Generative Pretrained Transformer)  

### 지도학습 / 비지도학습 / 강화학습   
지도학습 : 입력 데이터 X -> 정답 데이터 Y   
정의  
입력 데이터(X)와 그에 대응하는 정답 데이터(Y, 레이블)가 함께 제공되는 학습방식   
- 모델은 이러한 데이터를 학습하여 새로운 입력에 대한 정확한 출력을 예측함   
 주요 기법  
- 분류(Classification): 데이터를 미리 정의된 카테고리로 분류함(환자인지, 강아지/고양이/스팸판별)  
- 회귀(Regression): 연속적인 값을 예측함(공부시간 별 성적)  
예  
- 이메일 스팸 필터링: 이메일의 내용이나 메타데이터를 기반으로 스팸 여부를 분류함   
- 손글씨 숫자 인식: 이미지에서 손으로 쓴 숫자를 인식하여 디지털 형식으로 변환함   
- 주택 가격 예측: 주택의 면적, 위치, 방 수 등의 특성을 기반으로 가격을 예측함   
- 음성 인식: 음성 데이터를 텍스트로 변환함   
   
비지도학습    
정의  
- 정답 데이터(레이블) 없이 입력 데이터(X)만으로 학습하는 방식  
- 데이터의 숨겨진 구조나 패턴을 발견하는 데 중점을 둠   
주요 기법  
- 군집화(Clustering): 유사한 특성을 가진 데이터들을 그룹으로 묶음  
- 차원 축소(Dimensionality Reduction): 고차원 데이터를 저차원으로 축소하여 주요 특징을 추출함.(PCA)    
예  
- 고객 세분화: 고객의 구매 행동이나 특성을 기반으로 유사한 그룹으로 분류함  
- 이상 탐지: 정상 패턴에서 벗어난 데이터를 탐지하여 이상 여부를 판단함   
   
강화학습
정의  
에이전트(Agent)가 환경(Environment)과 상호작용하며 보상(Reward)을 최대화하는 행동 전략을 학습하는 방식  
- 에이전트는 행동에 따른 보상을 통해 최적의 정책을 학습함(장기적인 보상을 고려해야 함)  
 주요 개념  
- 에이전트(Agent): 행동을 수행하는 주체  
- 환경(Environment): 에이전트가 상호작용하는 대상  
- 상태(State): 현재 환경의 상황  
- 행동(Action): 에이전트가 취할 수 있는 선택지  
- 보상(Reward): 행동의 결과로 얻는 피드백  
 예  
- 게임 AI: 체스, 바둑 등에서 최적의 수를 두기 위해 학습함  
- 로봇 제어: 로봇이 주어진 작업을 효율적으로 수행하도록 학습함  
- 자율 주행: 자동차가 도로 상황에 맞게 주행 전략을 학습함  
- 추천 시스템: 사용자의 반응을 기반으로 개인화된 콘텐츠를 추천함  

|구분 | 유형 | 알고리즘 | 
|------|---|------|
|지도학습(Supervised learning)|분류|K-최근접 이웃(K-Nearest Neighbor. KNN),서포트 벡터 머신(Support Vector Machine.SVM), 결정 트리(Decision tree),로지스틱 회귀 (logistic regression)|
|       | 회귀| 선형회귀(Linear Regression)| 
| 비지도학습(Unsupervised learning)|군집|K-평균 군집화 (K-means clustering) 밀도 기반 군집 분석 (DBSCAN) |
|    | 차원 축소| 주성분 분석|
|강화학습(Reinforcement learning)| -  |마르코프 결정 과정(Markov Decision Process, MDP)  |

### 사전 지식  
독립변수와 종속변수  
독립 변수 X -> 모델 -> 종속변수 Y  
독립변수(Independent Variable):     
 - 종속변수에 영향을 주는 변수   
 - 모델이 입력값으로 사용하는 변수  

종속변수(Dependent Variable):   
 - 다른 변수(독립변수)에 의해 영향을 받는 변수   
 - 예측하려는 목표 변수

예시
 마케팅 분석  
- 독립변수: 광고 비용, 프로모션 횟수  
- 종속변수: 매출액  
 부동산 가격 예측  
- 독립변수: 면적, 방 개수, 위치  
- 종속변수: 주택 가격  
 운동과 체중 감량  
- 독립변수: 운동 시간, 칼로리 섭취량  
- 종속변수: 체중 변화  
   
관계   
"독립변수(X)가 변하면 종속변수(Y)도 변한다."    
수식 예제:   
Y = aX + b   
- X: 독립변수     
- Y: 종속변수   
- a, b: 계수 a-기울기 b-절편   
   
평균(Mean, Average)과 분산(Variance)  
평균 (Mean)중앙값(Median)과 다름  
- 데이터 값들의 대표적인 중심값  
- 값을 모두 더한 후 개수로 나눈 값  
예시  
- 시험 점수: 70, 80, 90의 평균  
- (70 + 80 + 90) ÷ 3 = 80   
- 월간 판매량: (100, 120, 140) → 평균: 120개   
분산 (Variance)  
- 데이터가 평균을 기준으로 얼마나 퍼져 있는지 나타내는 값  
- 값이 클수록 데이터가 분산되어(흩어져) 있음  
핵심 요약  
평균: 데이터의 중심값  
분산: 데이터가 퍼진 정도  
 평균이 같아도 분산이 다를 수 있음!  
예:  
- (78, 80, 82) 평균 = 80, 분산 작음   
- (60, 80, 100) 평균 = 80, 분산 큼   
   
### 딥러닝 문제해결 과정  

1. 해결할 문제 정의 -> 2.데이터 수집 -> 3. 데이터 가공(데이터 전처리) -> 4. 딥러닝 모델 설계(모델구조 구현) 5. 딥러닝 모델 학습 -> 6. 성능 평가  

----
## 3주차 텐서플로 기초
### 벡터, 행렬, 텐서
• 인공지능(머신 러닝/딥러닝)에서 데이터는 벡터(vector)로 표현  
• 벡터는 [1.0, 1.1, 1.2]처럼 숫자들의 리스트로, 1차원 배열 형태  
• 행렬(matrix)은 행과 열로 표현되는 2차원 배열 형태  
• 텐서는 3차원 이상의 배열 형태  
  
#### 텐서플로(tensorflow)
데이터 흐름 그래프(data flow graph)를 사용하여 데이터의 수치 연산을 하는 오픈 소스 소프트웨어 프레임워크  
텐서플로에서 데이터의 수치 연산을 수행하기 위한 그래프   
그림과 같이 그래프의 노드(node)는 수학적 연산을 처리하고, 에지(edge)는 노드 사이의 관계를 표현하며, 데이터(텐서(tensor)) 이동을 수행   
  
텐서플로 아키텍처  
• 준비된 데이터를 사용하여 모델(모형)을 생성하고 저장할 수 있음  
• 생성된 모델을 사용하여 분류 및 예측으로 마무리할 수도 있지만, 텐서플로 허브(TensorFlow Hub)에 게시하여 재사용할 수도 있음 또한, 사용자에게 웹이나 모바일로 서비스를 배포할 수 있는 환경도 제공됨  
  
모델(모형)생성 -> 모델(모형) 저장 -> 모델(모형) 배포   
  
모델(모형) 생성:  
• 데이터 훈련을 위한 데이터셋과 모델을 생성하고 훈련할 수 있는 환경을 제공함  
• 모델의 학습 과정을 시각화하여 보여 줄 수 있는 텐서보드 같은 도구들을 제공  
• 모델(모형) 저장:  
• 텐서플로는 분산 환경에서 모델을 저장하고 배포할 수 있는 환경을 제공  
• 특히 웹이나 모바일 같은 다양한 환경에서 사용 가능하도록 호환성이 고려된 모델 저장소를 제공  
• 모델(모형) 배포:  
• 서버나 웹 환경에서 텐서플로를 사용하면 언어 및 플랫폼에 상관없이 모델을 쉽게 학습시키고 배포할 수 있음  
• 텐서플로 2.x에서는 포맷을 표준화하기 때문에 플랫폼과 컴포넌트 간 호환성도 확보할 수 있음  
텐서보드: epoch에 따른 accuracy 정확도 를 정리해준 표를 제공해줌.  

### 텐서플로의 주요 문법 model.complie() model.fit() model.evaluate() model.predict() 
모델 컴파일(model.compile) 과정에서의 주요 파라미터  
모델을 훈련하기 전에 필요한 파라미터들을 정의함  
주요 파라미터는 optimizer, loss function, metrics임.  
- 옵티마이저(optimizer): 데이터와 손실 함수를 바탕으로 모델의 업데이트 방법을 결정함(Adam, Nadam....)  
- 손실 함수(loss function): 훈련하는 동안 출력과 실제 값(정답) 사이의 오차를 측정함   
wx+b를 계산한 값(모델의 예측)과 y(정답)의 오차를 구해서 모델 정확성을 측정함 (예) MSE 등   
- 지표(metrics): 훈련과 검증 단계를 모니터링하여 모델의 성능을 측정(Accuracy[ 0 ~ 1 ]...)  
  
model.compile(optimizer='adam', loss = 'sparse_categorical_crossentropy', metrics = ['accuracy'])  
ⓐ 아담(Adam) 옵티마이저를 사용  
ⓑ sparse_categorical_crossentropy는 다중 분류에서 사용되는 손실 함수  
ⓒ 'accuracy'는 훈련에 대한 정확도를 나타내는 것으로, 값이 1에 가까울수록 좋은 모델  
   
모델 훈련(model.fit) 과정  
• 앞서 만들어 둔 데이터로 모형을 학습(학습용/검증용 데이터)   
• 학습을 시킨다는 것은 y=wx+b라는 매핑 함수에서 w와 b의 적절한 값을 찾는다는 의미   
• w와 b에 임의의 값을 적용하여 시작하며, 모델에 데이터를 입력하면서 오차를 구하게 됨   
• 이때 오차가 줄어드는 방향으로 파라미터를 수정  

model.fit(x_train, y_train, epochs=10, batch_size=100, validation_data=(x_test, y_test), verbose =2)  
ⓐ 입력 데이터  
ⓑ 정답(label) 데이터  
ⓒ 학습 데이터를 학습하는 횟수  
ⓓ 한 번에 학습하는 데이터의 개수  
ⓔ 검증 데이터(validation data)  
각 epoch마다 검증 데이터의 정확도도 함께 출력하게 할 수 있음. epoch 마다 validation으로 평가  
검증 데이터로 확인된 정확도는 훈련이 잘 되고 있는지 보여주는 지표로 사용할 수 있으며, 검증 데이터를 모델이 보면서 학습하지는 않음  
ⓕ verbose 학습 진행 상황을 보여 줄지 옵션을 지정함  
    
모델 평가(model.evaluate) 과정  
• 주어진 검증 데이터셋을 사용하여 모델을 평가함   
• 평가가 끝나면 검증 데이터셋에 대한 손실 값과 정확도가 결과로 표시됨   
    
model.evaluate(x_test, y_test, batch_size=32)  
ⓐ 검증 데이터셋  
ⓑ 결과(label) 데이터셋  
ⓒ 한 번에 학습할 때 사용하는 데이터 개수  

모델 사용(model.predict) 과정  
• 훈련된 모델을 사용하여 다음 예시 코드처럼 실제 예측을 진행함  
model.predict(y_test)  

### 환경세팅
anaconda prompt 가상환경 dl 생성  
conda create -n dl  
conda activate dl   
pip install tensorflow  













----
